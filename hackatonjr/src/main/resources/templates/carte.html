<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carte</title>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 80px;
            background-color: #111827;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 0;
            gap: 20px;
        }

        .nav-btn {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            background-color: #1f2937;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #e5e7eb;
            font-size: 22px;
            text-decoration: none;
            transition: background-color 0.2s, transform 0.1s;
        }

        .nav-btn:hover { background-color: #4b5563; transform: translateY(-1px); }
        .nav-btn.active { background-color: #2563eb; }

        .container {
            flex: 1;
            padding: 20px 30px;
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
        }

        .form-block {
            background: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: flex;
            gap: 20px;
            justify-content: center;
        }

        select, button {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #ccc;
            font-size: 14px;
        }

        button {
            background-color: #2196F3;
            border: none;
            color: white;
            cursor: pointer;
        }

        button:hover { background-color: #1976D2; }

        svg {
            width: 100%;
            height: 600px;
            background: #e0f2f1;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .lieux circle {
            cursor: pointer;
            transition: 0.2s;
            stroke: #222;
            stroke-width: 1;
        }

        .lieux circle:hover {
            stroke-width: 2;
        }
    </style>
</head>

<body>

<div class="sidebar">
    <a href="/Catalogue" class="nav-btn" title="Boutique">üõí</a>
    <a href="/Carte" class="nav-btn active" title="Carte">üó∫Ô∏è</a>
    <a href="/Notifications" class="nav-btn" title="Notifications">üîî</a>
    <a href="/Astuces" class="nav-btn" title="Astuces">üí°</a>
    <a href="/Reglages" class="nav-btn" title="R√©glages">‚öôÔ∏è</a>
</div>

<div class="container">

    <h1>Carte Namek</h1>

    <!-- FORMULAIRE AVEC √âTAPE -->
    <form class="form-block" method="get">

        <label>D√©part :
            <select name="depart" id="depart">
                <option value="">‚Äî</option>
                <option th:each="l : ${lieux}" th:value="${l.nom}" th:text="${l.nom}"></option>
            </select>
        </label>

        <label>√âtape :
            <select name="etape" id="etape">
                <option value="">‚Äî</option>
                <option th:each="l : ${lieux}" th:value="${l.nom}" th:text="${l.nom}"></option>
            </select>
        </label>

        <label>Arriv√©e :
            <select name="arrivee" id="arrivee">
                <option value="">‚Äî</option>
                <option th:each="l : ${lieux}" th:value="${l.nom}" th:text="${l.nom}"></option>
            </select>
        </label>

        <button type="submit">Calculer</button>
    </form>

    <!-- SVG -->
    <svg>
        <!-- Chemins -->
        <g class="chemins">
            <line th:each="c : ${chemins}"
                  th:attr="x1=${c.a.x}, y1=${c.a.y}, x2=${c.b.x}, y2=${c.b.y}"
                  stroke="#8bc34a" stroke-width="3"/>
        </g>

        <!-- Lieux -->
        <g class="lieux">
            <g th:each="l : ${lieux}">
                <circle th:attr="cx=${l.x}, cy=${l.y}" r="10"
                        fill="#4caf50"
                        th:data-nom="${l.nom}"></circle>
                <text th:attr="x=${l.x + 14}, y=${l.y + 4}"
                      font-size="14" fill="#1b5e20"
                      th:text="${l.nom}"></text>
            </g>
        </g>

        <!-- Polyline du chemin -->
        <polyline th:if="${chemin != null}"
                  stroke="red" stroke-width="4"
                  fill="none"
                  th:attr="points=${#strings.join(chemin, ' ')}"/>
    </svg>
</div>

<!-- JS MINIMAL -->
<script>
document.addEventListener("click", e => {
    if (!e.target.dataset.nom) return;
    const nom = e.target.dataset.nom;

    const d = document.getElementById("depart");
    const ept = document.getElementById("etape");
    const a = document.getElementById("arrivee");

    if (!d.value) d.value = nom;
    else if (!ept.value) ept.value = nom;
    else a.value = nom;
});
</script>

</body>
</html>
